#  心得体会

## 2022年2月

### 2/11

​	又是时隔一个月，就是修复一些小bug，搞一下快捷键，搞一下发布模式的逻辑，根据文章ID来自动选取，没有就创建新文章，有就自动判断，下一次新增估计又是很久以后了吧。

## 2022年1月

### 1/14

​	今天正好是博客上线半周年的时间，也是push-markdown v1.0.0上线半周年的时间，就随便弄了一下，把滚动条的样式修改了一下，欢迎界面不要滚动条样式了，隐藏起来，这样子好看一点。然后就是获取文章的ID值，之前都需要去猜测这台设备有没有这篇文章的本地缓存，现在显示出来，这样子方便查看到。大概就做了这么点工作，毕竟已经很完善了，没有什么需要新增的了，现在真的是挺满足的了。

## 2021年12月

### 12/22

​	今天小改版一下，升级一下体验，版本是v1.0.3。这几个小修改可以增加，但是多少影响了体验，有点强迫症，提示不够友好，不知道的还以为软件卡住了，没有提示不太好。

### 12/18

​	没想到又是一波新的更新，这次更新间隔比较短，算是做了之前的痒点。一个是自动检测新增不检查网络图片，仅利用本地缓存，大大加快发布速度，另一个是手动发布新增使用远程文章的网络图片来更新本地缓存。之前发布[QQ堂停运](https://szx.life/qq-tang-ting-yun/)这个的时候，是在自己的电脑上发布的，那么实验室的电脑上就没有这个本地缓存，之前老的机制是本地没有缓存，就采取强制更新的方式把远程文章的图片再重新更新一遍。这种方法有两点问题：1、会浪费时间，再更新这么多图片，会导致push-markdown有点假死的状态。2、wordpress强制更新图片，虽说理论上应该不会出问题，但我怕一旦文件多起来，说不定会出bug。因此我新增了从网络文章中扒取下来这个选项，在获取旧文章的同时，可以获得文章中的img的src，然后更新到本地缓存中，这样子就省时省力多了。还有一个是检查网络图片，这步当图片多起来的时候，每次都要检查，其实没什么必要，本地有缓存就行了，网络的又不会丢，检查那么多图片反而带来很大的延迟和浪费带宽，不检查直接加快和省流，一举两得。

### 12/14

​	没想到前端项目都过去一个月了，时间有点快啊，今天才发现锚点又有点问题了，之前把整个字符串的标点符号都去除了，这样导致所有的url都坏了，只用判断是不是本地锚点就行了，就indexOf(#)==0的替换就行了，顺便toLowerCase就行了。

​	顺便把这个重启文件的逻辑给修改了，现在非常的顺畅，直接修改file，不会关闭再打开，会卡一下，现在非常的丝滑啊，舒服了。

## 2021年11月

### 11/20

​	今天组长修复了一下主题的bug，然后我升级了一下一些依赖，感觉更新很快嗷，然后调整了文本框的界面大小。差不多，小修小补，如果没有大的bug，就应该是正式版的1.2.0。

### 11/19

​	连干两天，看起来工作量非常的少，但是确实花了不少时间，这两天适配了一下cnblog，本来还想着适配一下开源中国的，因为找不到API文档，老是报错也不知道缺少什么字段，最后还是放弃了，找了半天也没有资料说能够使用，而且开源中国的博客非常的卡，经常连不上，断网，非常的拉胯。说一下适配cnblog这个情况吧，之前适配cnblog的时候就能够发送图片，但是图片一直发送失败，不知道是什么情况，这两天着重看了一下，还去问了博客园的技术人员，说是要base64的二进制进行传输，我试了好多次，就是不行，后来单独另开一个测试，发现可以，也不用其他的库，直接用`Buffer.from(base64_string,'base64')`就能获得二进制的base64。但是怪就怪在，我把代码原封不动的带回来就不行，经过我自己排查，我在预加载的文件返回 `new MetaWeblog`不行，不能返回一个实例化的对象，里面都是空的，这样子发送图片就会失败，但怪就怪在，wordpress是可以的，就很蛋疼，但是我又不想放开安全权限，最后采用IPC进程间的通信，把`newMediaObject`这块代码放在electron里面，而且不能传递对象，只能传递简单的，所以就把base64传递过去，然后再视情况判断要不要进行变成二进制，最终就完成了我的效果，经典代码屎山。

​	我们组组长帮忙适配了主题，不亏是学过前端的，上手悟的很快，虽然改了好几次，不过一天内能搞定，还是非常的快的，所以这次就是1.2.0，bug修复还是挺多的，界面也越来越美观了，真不错。

### 11/16

​	由于加入了阿里前端训练营，需要以小组的单位做一个项目，一开始想做win11，可是我一查github，直接已经有人做了，项目初始化都是六个小时之前的事情，后来我觉的和别人做重复的不太好，反正一周啥事都干不成，不如献祭出自己的项目，大家都同意了。

​	可惜大家的积极性都不高，我也没办法了，我只能自己做了，至少我自己懂我自己的项目架构和缺点，只能慢慢修改bug了。

​	周日就开始了，昨天也干了，今天把我的第一个目标完成了，就是在侧边栏加入文件列表，然后能够显示当前文件的路径下的所有文件，也可以进行点击打开文件，或者返回上一级的页面，同时可以隐藏和显示。

​	还修复了三个bug，虽然都比较简单，但是需要找到问题的根源在哪儿。

## 2021年10月

### 2021/10/3

​	由于静态备份网站的时候，因为中文URL会出不少的问题，所以就新增空白URL的功能，自动将标题的中文转换为拼音，这样子也不用我每次都要费劲脑汁去想英文。

## 2021年9月

### 2021/9/21

​	今天上传很多图片的文档发现有问题，老是会有新的图片出来，明明我的图片设置逻辑是强制更新旧的图片，不会有新的图片出来，经查找，一个是CDN访问阈值的问题，图片检测的次数超过了访问阈值，就会检测失败，然后就会强制更新图片，又因为我写的脚本有个小错误，导致强制更新图片的逻辑是错误的，所以就出大问题。

### 2021/9/3

​	浪费了五六个小时吧，想弄推送到cnblog，发现不太好弄，纯文字的是能够做到，但是图片上传就是不行，要求的格式是base64，但又要求Byte[]格式的，所以搞得我也不知道了到底是什么情况。一直报错，我也不想弄了，主要我也不用cnblogs，再网上一搜，发现都有了，毕竟大家用cnblogs的比较多， 自己搭博客的越来越少了。那就用他们的软件就行了，我的自用能够推送到WordPress就行了。

### 2021/9/2

​	今天把昨天的烂尾收一下，就再更新了一下使用教程，到现在为止，这个软件终于能够正常的使用了，非常的舒服，断断续续开发了一个半月吧，总工作时间量大概在20天左右，总算把这个项目的1.x弄完了，接下来估计也是修修bug。从一个什么都不会的electron开发者，到现在会那么一点，还是很欣慰的。但markdown最重要的部分，都是通过库来解决，也不是我个人的意志。不过也是多亏了前人打下的江山，让我修修补补容易了不少。好，很有精神！

### 2021/9/1

​	没时间了，具体看v1.1.0，还更新了使用教程，花了我好多时间。

## 2021年8月

### 2021/8/30

​	软件有半个多月没有更新了，因为没啥大的bug，今天修复了五个bug，还是蛮不错的嗷。具体版本号是1.0.6。有个TOC目录的软件的bug我就不弄了，正经人谁放TOC，而且我博客能够正常跳转就行了，这个软件内看看样式就行了，扎不多得了。把之前返的点击外链是页内跳转的问题给修复了，没想到还挺简单的，复制粘贴解决方法就行了，哈哈哈。这次点击sample样例没有反应我是没有想到的，之前都有的，因为之前两个测试软件和正式软件装在一台电脑上，他不知道怎么回事读到测试软件上的sample，不过问题不大，毕竟解决了。最舒服的还是把webSecurity给重新改回true了，我的软件终于又是安全的了，安全最重要了！

### 2021/8/11

​	其实昨天就有个日志的，太晚没写，就和今天一块好了。首先是历史状态的保存，就是将watch加上一个deep就行了，深层监控，这样子就行了。

​	没有修改状态的保存是因为vue2之前换过来，注释掉`this.$set`这条语句，因为vue3不支持了，需要用到reactive这个语句，然后就行了。山重水复疑无路，总有办法能够解决的，直接一波更新v1.0.5版本。

### 2021/8/10

​	修复了一下tab问题，今天上传的文章发现代码中出现emsp，之前没发现是因为代码都是顶格的，没注意到，而且我以为typora中的代码缩进会自动把tab变成四个空格，结果是tab显示成四个空格。之前暴力替换法不太行，最后还是遍历渲染后的markdown的p标签，把所有的tab换成emsp，因为代码用的全是code和span，根本没有p，舒服了一手。

​	然后弄脚本替换，烦死了，早知道不弄了，废了我好久的时间，真的是难弄，多行文本根本没法替换，也不知道用sed的人怎么想的，python才是yyds好吧，但是我也不想用python，sh文件还是更加方便，尤其是对于这种情况。

### 2021/8/8

​	这一段时间的都在忙自己事情，有快两周没有更新这个软件了，还有一些小bug，目前看不顺眼的就是图片不居中的问题，很简单，就是找到img标签的父标签，判断里面有没有文字，如果没有文字，即为单独的图片，那么就居中。三行就完事了，忙里抽空改bug。

​	结果刚提交完，就发现一个bug，因为typora中可以改图片大小，调成百分之多少，但这个时候就不是`[]()`这种格式，而是会变成`<img src="images/1627475002683.webp" alt="1627475002683" style="zoom:50%;" />`这种格式，那么markdown-it渲染的时候不考虑img这种html标签，不会套一个p标签，因此需要手动套一个p标签，然后再居中。

## 2021年7月

### 2021/7/28

​	今天更新了图片的逻辑，详情看1.0.4版本更新即可。这次进展还行吧，主要是对wordpress覆盖逻辑的修改这个比较麻烦，因为我不会php，也不会wordpress这些api，虽然死磕肯定能弄出来，但我不想死磕，就硬找有没有现成代码，经过不懈努力终于找到了，要不然我人就没了，舒服了嗷。

​	晚上弄wordpress的webp格式，就是加一行代码，非常简单，只不过删除原来的jpg，还要转换webp比较麻烦。

### 2021/7/27

​	又是一手好几天没有更新，就修改了更新远程文章的逻辑，这次进展算是比较顺利的，没有什么麻烦，感觉完成的还不错，详情看1.0.3版本更新即可。

### 2021/7/21

​	今天改了几个bug，一个是图片本地加载不成功的，原因是地址被编码为url，所以加载不成功，urldecode一下就行了。还有一个是摘要自动提取的问题，就是库用不对了，之前应该是8.0.0，现在是7.1.1，所以可能忘改动了。

### 2021/7/17

​	已经有几天没开发了，前两天在弄博客，已经弄得差不多了。今天本来是弄项目的，又不知怎么又想解决markdown的一个看似bug却不是bug的东西。就是在typora中的一个tab显示是一个全角空格，在github上和博客上都显示的是一个空格，这样子感觉就非常难受。虽然Markdown可以不用首行缩进，因为会有一个空行来区分段落。而我写文章已经习惯了使用Tab键来区分段落之间，语文课和word使用的习惯吧。

​	于是我上网查怎么解决，一开始我是想找找有没有tab键转换成空格键，因为vscode就是这样子操作的，后来看了一下typora只能修改代码里的tab键的空格数，但是我要实现普通文本的替换。再进一步发现，markdown本身就是通过4个空格的方式来实现代码格式（应该把，因为我一直用typora，不怎么会用源代码模式编写），反正就有、尿。

​	解决的一种方式是在写Markdown的时候使用`&emsp;`来进行缩进，但我每段前面都加个这个也太蛋疼了8，或者用脚本一键替换，最终我还是选择github或者gitee上就按他们默认的tab渲染方式吧，毕竟我不可能放弃tab键这么简单的操作，就只能把Push markdown的逻辑给改一下，就直接把文本的`\t`替换为`&emsp;`就行了，这样子推送到博客的文章如果使用了tab，就能变成一个全角空格，舒服了很多。

### 2021/7/14

​		终于完成了1.0.0的版本建设，10天的工作量，终于差不多把原来的源代码全部挪过来，逻辑和方法都没改，就是变成TypeScript（AnyScript😁）。虽然现在还有很多很多问题，比如去除了MathJax，因为原来的代码不能试用，而且我也没有这方面的需求，还有图片上传逻辑等等，但毕竟现在能用，就已经大告成功了。

​	可以推送博客了，好耶 ( •̀ ω •́ )✧。

### 2021/7/13

​	今天学习进展还行，这个图片的问题算是解决了。图片上传默认编码发现不行，不知道为什么，原来的工具是可以支持的，明明代码都是一样的，所以需要改一下wordpress下mw_newMediaObject的解码方式为base64，然后本地也通过base64加密就行了，但是这个上传的逻辑还是需要我想一想，再重新构思一遍应该怎么弄，尤其是我多台设备之前，至少两台电脑，总不能都用本地缓存吧，如果能只获取图片的头部信息的话，那么就能砍掉本地缓存这一招，因为这样子可以确保以WordPress的库存为基础。当然，有人会想那多台设备之间的文件你怎么确保是一致的呢？因为我充钱了，用的WPS网盘，自动同步的，当然今天出了点问题，发现自己电脑没有同步过来，反正有点尿，可能是那边没有开启wps网盘就会出现这种状况，不知道能不能借用一下git的想法，这样子当然是最好的啦，行，溜了。

### 2021/7/12

​	今天人有点麻，在寝室学习效率不行，不过已经能够推送非图片的markdown了，有图片的markdown老是各种报错，人就很尿。nginx还各种限制，文件大小限制等等，不过稍微改了一下，原来的应用程序就能用了，要不然会报错`Unknown XML-RPC tag 'TITLE'`也不知道是什么情况，之前明明测试过可以推送，也确实有图片可以推送，不知道是不是没有超过8M的限制了，也可能和今天的域名下来和CDN加速有关吧。明天再看看吧，去实验室开发吧，宿舍是真不行。

### 2021/7/11

​	mathjax打算先不弄了，先把推送给做出来，然后1.0就能成型了，希望能尽快做出来吧，还有好多问题要改呢，这个原作者好多库我都不会用，还得慢慢来看看。

### 2021/7/10

​	烦啊，这个markdown的东西确实难搞， 现在只能稍微看一下，markjax还弄不起来，不过U1S1，我确实用不到公式，但如果日后需要，那么我就要继续弄，真的龙鸣好吧。现在的问题是那个滚动条会有两个，electron会自带一个滚动条，就很煞笔，不知道怎么取消，找了一下也没有electron关闭滚动条的操作，唉，还得再看看吧，不早了，溜了。

### 2021/7/8

​	今天本身计划是没有做这个项目的，但是还是忍不住做了。然后一如既往的浪费时间，本想改一下标题栏的样式的，之前项目应该能够通过electron-vue这个组件在打包的时候修改样式，可惜现在没用这个，就改不了。目前我看有的库需要开启remote才能够实现，但我又不想弄成那样子，就很麻瓜，遂放弃了，加入以后的计划吧，说不定有空就实现了呢，然后尝试弄了一下tab栏，发现还是要把所有的界面给完成才能。

### 2021/7/7

​	今天进展也是非常的缓慢。下午看了一下源代码的目录结构，感受一下，本想直接用，发现不能这样子，会有大大的问题，遂放弃。vue-i18n又遇到问题，虽说有安全问题，但还是用v-html 先顶一下，现在先凑活，到后面可以改成组件插入。然后加了几个文件，刚改了一下链接，尿了，发现今天啥都没干，就很难顶。

### 2021/7/6

​	今天感觉干了什么，又没有干什么。下午看了一下安全指南，昨天那个示例发现不太合适，因为他自己封装了太多的东西，就看那个最简单的就行了，而且vue-cli-plugin-electron-builder里面也有说明怎么用preload，但其实引用的还是昨天那个示例作者的说法😅。通过复杂的操作来换取安全，我真的尿了，就是你和本地路径相关的操作在渲染进程都不能用，就只能提前通过preload来加载，算了，都决定要安全了，就一路到底吧。

​	晚上看了一下vue-i18n的教程，发现还有一些高端操作，可惜我用不太上，就中英文切换应该就够了，怎么切换我也找了好久，有些都不能直接用，vue3切换需要在setup()里面进行全局切换，反正最终搞定了。

​	发现vue的基础还是太过于薄弱了，相当于什么都不会，明天什么都不敢，就看vue3教程，看看能不能硬看懂。

### 2021/7/5

​	那么今天有点浑浑噩噩，但也不是我想这么做，总体界面还是没有变动，找到一个挺不错的[便签应用](https://github.com/heiyehk/electron-vue3-inote)，就是使用electron11+vue3+TypeScript构建的，应该能够借鉴一些，虽然整个界面差的非常远。今天添加了一下Error错误信息处理，虽然就这一个文件，但我也是累的够呛的。首先是他也用了remote模块，官方并不推荐这种方法，因为会有安全问题，所以我小研究了一下ipcMain这个，在主进程和渲染进程中进行沟通，因为vue使用的是渲染线程，有点尿。然后我看到官方文档也不推荐nodeIntegration，建议使用preload来加载文件，但我又不会，刚找到一个[electron安全模版](https://github.com/reZach/secure-electron-template)，明天研究一下怎么使用，还是为了安全一点，毕竟我真的怕安全问题，到时候自己网站和电脑都挂了就麻烦了，行。不早了，明天再看。

### 2021/7/4

​	第一次代码重构，先把electron13+vue3+TypeScript的示例给跑起来，发现安装包居然有56M，安装完的大小能有180M，比原软件大了50M，不知道怎么优化，说实话，也不一定需要优化，但到时候再看吧。

​	然后进行第一步的代码重构，尝试使用i18n插件，毕竟原软件就有两种语言，我也不需要花力气重写文字。之后完成菜单栏的替换，把文字和动作都给替换了，果然有前人的铺垫，路就是好走啊。
