# 项目搭建

i-notes项目：https://heiye.me/blog/%E3%80%90electron-vue3-ts%E5%AE%9E%E6%88%98%E4%BE%BF%E7%AC%BAexe%E3%80%91%E4%B8%80%E3%80%81%E6%90%AD%E5%BB%BA%E6%A1%86%E6%9E%B6%E9%85%8D%E7%BD%AE/#more

## 参考文档

原项目源代码：https://github.com/jzj1993/PublishMarkdown

原项目技术实现：https://www.paincker.com/publish-markdown-tech

vue-cli4+electron搭建：https://zhuanlan.zhihu.com/p/75764907

vue-cli-plugin-electron-builder文档：https://nklayman.github.io/vue-cli-plugin-electron-builder/guide

vue-i18n使用：https://blog.csdn.net/weixin_45625609/article/details/118027523，https://blog.csdn.net/qq_43574079/article/details/112473914

electron-store用法：https://www.npmjs.com/package/electron-store

electron中文文档：https://www.electronjs.org/docs/api/menu、https://www.w3cschool.cn/electronmanual/

## 环境搭建

版本：nodejs 14.17+windows

### 全局插件

- yarn
- @vue/cli

### 0、修改yarn的源

yarn的目录在`~/.yarnrc`

```
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1

registry "https://registry.npm.taobao.org"
chromedriver_cdnurl "https://npm.taobao.org/mirrors/chromedriver/"
electron_mirror "https://npm.taobao.org/mirrors/electron/"
ignore-engines true
lastUpdateCheck 1625206841438
phantomjs_cdnurl "http://cnpmjs.org/downloads"
profiler_binary_host_mirror "https://npm.taobao.org/mirrors/node-inspector/"
sass_binary_site "https://npm.taobao.org/mirrors/node-sass/"
sqlite3_binary_host_mirror "https://foxgis.oss-cn-shanghai.aliyuncs.com/"
```

### 1、vue

安装@vue/cli

```bash
yarn global add @vue/cli
```

用vue-cli4创建一个新的项目，选择vue3.0+TypeScript+eslint+prettier

```bash
#创建项目
vue create publish-markdown
#然后手动选择配置
cd push-markdown
```

### 2、electron

```bash
vue add electron-builder
```

然后重新删了node_modules和yarn.lock，安装，因为自己生成的有点问题

```bash
yarn install
#更新所有的到最新的状态，当然有些还是要手动更新
yarn upgrade --latest
#如果使用@vue/typescript，那么就引用一下下面这个
vue invoke electron-builder
```

启动

```bash
yarn electron:serve
```

文件打包的配置（示例）：

```
"build": {
    "productName":"xxxx",		//项目名 这也是生成的exe文件的前缀名
    "appId": "com.xxx.xxxxx",	//包名  
    "copyright":"xxxx",			//版权信息
    "directories": { 			//输出文件夹
      "output": "build"
    }, 
    "nsis": {	//nsis相关配置，打包方式为nsis时生效
      "oneClick": false, 								// 是否一键安装
      "allowElevation": true, 							// 允许请求提升，如果为false，则用户必须使用提升的权限重新启动安装程序。
      "allowToChangeInstallationDirectory": true, 		// 允许修改安装目录
      "installerIcon": "./build/icons/aaa.ico",			// 安装图标
      "uninstallerIcon": "./build/icons/bbb.ico",		//卸载图标
      "installerHeaderIcon": "./build/icons/aaa.ico", 	// 安装时头部图标
      "createDesktopShortcut": true, 					// 创建桌面图标
      "createStartMenuShortcut": true,					// 创建开始菜单图标
      "shortcutName": "xxxx", 							// 图标名称
      "include": "build/script/installer.nsh", 			// 包含的自定义nsis脚本
    },
    "publish": [
      {
        "provider": "generic", 		// 服务器提供商，也可以是GitHub等等
        "url": "http://xxxxx/" 		// 服务器地址
      }
    ],
    "win": {
      "icon": "build/icons/aims.ico",
      "target": [
        {
          "target": "nsis",			//使用nsis打成安装包，"portable"打包成免安装版
          "arch": [
            "ia32",				//32位
            "x64" 				//64位
          ]
        }
      ]
    },
    "mac": {
      "icon": "build/icons/icon.icns"
    },
    "linux": {
      "icon": "build/icons"
    }
  }
```

